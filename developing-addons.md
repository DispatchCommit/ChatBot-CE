# Developing Addons

## What are addons

Addons are pieces of code that ChatBot-CE loads into the bot when it joins your room. These addons contain commands that can be run directly from the chat, just like a normal chat bot. These addons, via the `constructor` can also do more than just commands if programmed to do so.

## Developing An Addon

There's two important pieces to the addon which are required for it too function. Well, really only one is required, the other would be just stupid not to include unless you're only sending web requests or something else of the sort. This is the `commands` array and the `constructor` method.

### Example Addon

Here's an example addon called `ping`

```javascript
exports.commands = ["ping"];

let api;
let helper;

exports.constructor = (api, helper) => {
    this.api = api;
    this.helper = helper;
};

exports.ping = {
    execute: (command, parameters, message) => {
        this.api.say("pong");
    }
};
```

Let's break this down. The `commands` array is just an array of commands you want the bot to detect. The `constructor` method will always be ran when present, the two parameters are related to our `BotAPI` and our `BotHelper`. It would be a bit insane to not include those. The constructor is where you can handle any automated functions you need to start such as timers, automated messages, etc.

The `exports.ping` is the actually chat command. You see that it's an object with an `execute` method inside. This is on purpose so we can add more info to the object later. The `execute` method is ran when the command is detected. It takes 3 parameters: `command`, `parameters`, and `message`. `command` is just the command itself (such as `!help` but without the `!`). The `parameters` is all the stuff after the command split at the space. So it would be either `null` if no parameters, or be an array of parameters (ex `!help command ping` would be `["command", "ping"]`). `message` is the `IChatMessage` interface. This can be found in the docs generated by TypeDoc.

### Events
ChatBot CE comes with a event-style system. Just add the event to your addon and boom. The system will detect it when it loads your addon. This has the exact same setup as commands with the `execute` method inside the object.

#### Available Events
`onChatMessage (data, IChatMessage)` 

#### Example
**Add Points**
```javascript
exports.onChatMessage = {
	execute: (data, chatMessage) => {
		if(chatMessage.username = "awesomeuser") {
			addPoints(chatMessage.username);
		}
	}
}
```

This example assumes your addon is some form of point system. `addPoints` is completely fictional. 

`chatMessage` is an instance of the `IChatMessage` interface at `lib/interfaces/MessageInterfaces.ts#7`. You have access to all data available in it.

**Erase All Messages**
```javascript
exports.onChatMessage = {
	execute: (data, chatMessage) => {
		this.api.erase([chatMessage.messageId]);
	}
}
```
Now every message sent will immediately be erased.

### Package
The `package.json` is just a standard [NPM](https://www.npmjs.com/) style package. The example for the addon above would be

```json
{
    "name": "ping",
    "version": "1.0",
    "main": "ping.js"
}
```
